lmcache:
  global:
    nameOverride: ""
    fullnameOverride: ""

  controllers:
    main:
      strategy: RollingUpdate

      annotations: {}

      containers:
        main:
          image:
            repository: "lmcache/vllm-openai"
            tag: "0.3.7"
            pullPolicy: IfNotPresent

          env:
            LMCACHE_USE_EXPERIMENTAL: "True"
            LMCACHE_CONFIG_FILE: "/etc/lmcache/lmcache_config.yaml"

          probes:
            liveness:
              enabled: true
              spec:
                httpGet:
                  path: "/health"
                  port: 8000
                initialDelaySeconds: 30
                periodSeconds: 10
                timeoutSeconds: 5
                failureThreshold: 3
            readiness:
              enabled: true
              spec:
                httpGet:
                  path: "/health"
                  port: 8000
                initialDelaySeconds: 5
                periodSeconds: 5
                timeoutSeconds: 3
                failureThreshold: 3

          resources:
            requests:
              memory: "4Gi"
              cpu: "2000m"
            limits:
              memory: "8Gi"
              cpu: "4000m"

  podOptions:
    securityContext:
      runAsUser: 1000
      runAsGroup: 1000
      fsGroup: 1000
      fsGroupChangePolicy: "OnRootMismatch"

  enabled: true
  chunk_size: 256
  local:
    cpu:
      size: 2048
    disk:
      path: "/var/lib/lmcache"
      size: 10240
  remote_url: "redis://{{ .Values.lmcache.redis.host }}:{{ .Values.lmcache.redis.port }}"
  cache_strategy: "multi_tier"

  service:
    main:
      controller: main
      type: ClusterIP
      ports:
        http:
          port: 80
          targetPort: 8000

  ingress:
    main:
      enabled: false

  persistence:
    lmcache-config:
      type: configMap
      name: lmcache-config
      advancedMounts:
        main:
          main:
            - path: /etc/lmcache
    lmcache-disk:
      enabled: true
      type: persistentVolumeClaim
      storageClass: standard
      accessMode: ReadWriteOnce
      size: 50Gi
      advancedMounts:
        main:
          main:
            - path: /var/lib/lmcache
              readOnly: false

  configMaps:
    lmcache-config:
      enabled: true
      data:
        lmcache_config.yaml: |
          enabled: {{ .Values.enabled }}
          chunk_size: {{ .Values.chunk_size }}
          cache_strategy: "{{ .Values.cache_strategy }}"
          local:
            cpu:
              size: {{ .Values.local.cpu.size }}
            disk:
              path: "{{ .Values.local.disk.path }}"
              size: {{ .Values.local.disk.size }}
          remote_url: "{{ .Values.remote_url }}"

  nodeSelector: {}
  tolerations: []
  affinity: {}

  redis:
    host: "redis-master.redis.svc.cluster.local"
    port: 6379
