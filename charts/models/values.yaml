gatewayRef:
  name: ai-gateway

envoyRateLimit:

backendTrafficPolicy:
  name: backend-retry-policy
  labels: {}
  annotations: {}
  targetRefs:
    - group: gateway.networking.k8s.io
      kind: Gateway
      name: ai-gateway
  retry:
    numRetries: 3
    perRetry:
      backOff:
        baseInterval: 100ms
        maxInterval: 10s
      timeout: 30s
    retryOn:
      httpStatusCodes:
        - 500
        - 502
        - 503
        - 504
        - 404
      triggers:
        - connect-failure
        - retriable-status-codes

backendDefaults:
  fireworks: &fireworksBackend
    schema: OpenAI
    prefix: /inference/v1
    fqdn:
      hostname: api.fireworks.ai
      port: 443
    securityType: APIKey
    tlsHostname: api.fireworks.ai
  openai: &openaiBackend
    schema: OpenAI
    fqdn:
      hostname: api.openai.com
      port: 443
    securityType: APIKey
    tlsHostname: api.openai.com
  vertexAi: &vertexAiBackend
    schema: GCPVertexAI
    fqdn:
      hostname: us-central1-aiplatform.googleapis.com
      port: 443
    type: GCPCredentials
    gcpCredentials: &vertexAiCredentials
      projectName: kivoyo
      region: us-central1
    tlsHostname: us-central1-aiplatform.googleapis.com
  googleAiStudio: &googleAiStudioBackend
    schema: OpenAI
    prefix: v1beta/openai
    fqdn:
      hostname: generativelanguage.googleapis.com
      port: 443
    securityType: APIKey
    tlsHostname: generativelanguage.googleapis.com

backends:
  fw-01:
    <<: *fireworksBackend
    secretRef:
      name: fireworks-api-key-01
    resourceName: fw-backend-01-svc
  fw-02:
    <<: *fireworksBackend
    resourceName: fw-backend-02-svc
    secretRef:
      name: fireworks-api-key-02
  openai-01:
    <<: *openaiBackend
    resourceName: openai-backend-01-svc
    secretRef:
      name: openai-api-key-01
  openai-02:
    <<: *openaiBackend
    resourceName: openai-backend-02-svc
    secretRef:
      name: openai-api-key-02
  vertex-ai-01:
    <<: *vertexAiBackend
    resourceName: vertex-ai-backend-01-svc
    gcpCredentials:
      <<: *vertexAiCredentials
      credentialsFile:
        secretRef:
          name: gcp-service-account-key-01
  vertex-ai-02:
    <<: *vertexAiBackend
    resourceName: vertex-ai-backend-02-svc
    gcpCredentials:
      <<: *vertexAiCredentials
      credentialsFile:
        secretRef:
          name: gcp-service-account-key-02
  google-ai-studio-01:
    <<: *googleAiStudioBackend
    resourceName: google-ai-studio-backend-01-svc
    secretRef:
      name: google-ai-studio-api-key-01
  google-ai-studio-02:
    <<: *googleAiStudioBackend
    resourceName: google-ai-studio-backend-02-svc
    secretRef:
      name: google-ai-studio-api-key-02

models:
  # Fireworks AI Models
  # qwen3-coder-480b-a35b-instruct:
  #   enabled: true
  #   envoyRateLimit:
  #     requests: 50000
  #     unit: Minute
  #   backends:
  #     fw-01:
  #       enabled: true
  #       ref: fw-01
  #       modelNameOverride: "accounts/fireworks/models/qwen3-coder-480b-a35b-instruct"
  #       priority: 0
  #     fw-02:
  #       enabled: true
  #       ref: fw-02
  #       modelNameOverride: "accounts/fireworks/models/qwen3-coder-480b-a35b-instruct"
  #       priority: 1

  kimi-k2-instruct-0905:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1500000
      - unit: Month
        tokens: 35000000
      - unit: Year
        tokens: 420000000
    backends:
      fw-01:
        ref: fw-01
        modelNameOverride: "accounts/fireworks/models/kimi-k2-instruct-0905"
        priority: 0
      fw-02:
        ref: fw-02
        modelNameOverride: "accounts/fireworks/models/kimi-k2-instruct-0905"
        priority: 1

  kimi-k2-thinking:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 800000
      - unit: Month
        tokens: 15000000
      - unit: Year
        tokens: 180000000
    backends:
      fw-01:
        ref: fw-01
        modelNameOverride: "accounts/fireworks/models/kimi-k2-thinking"
        priority: 0
      fw-02:
        ref: fw-02
        modelNameOverride: "accounts/fireworks/models/kimi-k2-thinking"
        priority: 1

  deepseek-v3p1:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1500000
      - unit: Month
        tokens: 35000000
      - unit: Year
        tokens: 420000000
    backends:
      fw-01:
        ref: fw-01
        modelNameOverride: "accounts/fireworks/models/deepseek-v3p1"
        priority: 0
      fw-02:
        ref: fw-02
        modelNameOverride: "accounts/fireworks/models/deepseek-v3p1"
        priority: 1

  qwen3-235b-a22b-instruct-2507:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1000000
      - unit: Month
        tokens: 20000000
      - unit: Year
        tokens: 240000000
    backends:
      fw-01:
        ref: fw-01
        modelNameOverride: "accounts/fireworks/models/qwen3-235b-a22b-instruct-2507"
        priority: 0
      fw-02:
        ref: fw-02
        modelNameOverride: "accounts/fireworks/models/qwen3-235b-a22b-instruct-2507"
        priority: 1

  # llama4-maverick-instruct-basic:
  #   enabled: true
  #   envoyRateLimit:
  #     requests: 50000
  #     unit: Minute
  #   backends:
  #     fw-01:
  #       enabled: true
  #       ref: fw-01
  #       modelNameOverride: "accounts/fireworks/models/llama4-maverick-instruct-basic" 
  #       priority: 0
  #     fw-02:
  #       enabled: true
  #       ref: fw-02
  #       modelNameOverride: "accounts/fireworks/models/llama4-maverick-instruct-basic"
  #       priority: 1

  # llama-v3p1-8b-instruct:
  #   enabled: true
  #   envoyRateLimit:
  #     requests: 50000
  #     unit: Minute
  #   backends:
  #     fw-01:
  #       enabled: true
  #       ref: fw-01
  #       modelNameOverride: "accounts/fireworks/models/llama-v3p1-8b-instruct"
  #       priority: 0
  #     fw-02:
  #       enabled: true
  #       ref: fw-02
  #       modelNameOverride: "accounts/fireworks/models/llama-v3p1-8b-instruct"
  #       priority: 1

  gpt-oss-120b:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1000000
      - unit: Month
        tokens: 20000000
      - unit: Year
        tokens: 240000000
    backends:
      fw-01:
        ref: fw-01
        modelNameOverride: "accounts/fireworks/models/gpt-oss-120b"
        priority: 0
      fw-02:
        ref: fw-02
        modelNameOverride: "accounts/fireworks/models/gpt-oss-120b"
        priority: 1

  gpt-oss-20b:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1500000
      - unit: Month
        tokens: 35000000
      - unit: Year
        tokens: 420000000
    backends:
      fw-01:
        ref: fw-01
        modelNameOverride: "accounts/fireworks/models/gpt-oss-20b"
        priority: 0
      fw-02:
        ref: fw-02
        modelNameOverride: "accounts/fireworks/models/gpt-oss-20b"
        priority: 1

  qwen3-235b-a22b-thinking-2507:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 800000
      - unit: Month
        tokens: 15000000
      - unit: Year
        tokens: 180000000
    backends:
      fw-01:
        ref: fw-01
        modelNameOverride: "accounts/fireworks/models/qwen3-235b-a22b-thinking-2507"
        priority: 0
      fw-02:
        ref: fw-02
        modelNameOverride: "accounts/fireworks/models/qwen3-235b-a22b-thinking-2507"
        priority: 1

  qwen3-coder-30b-a3b-instruct:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 2000000
      - unit: Month
        tokens: 45000000
      - unit: Year
        tokens: 540000000
    backends:
      fw-01:
        ref: fw-01
        modelNameOverride: "accounts/fireworks/models/qwen3-coder-30b-a3b-instruct"
        priority: 0
      fw-02:
        ref: fw-02
        modelNameOverride: "accounts/fireworks/models/qwen3-coder-30b-a3b-instruct"
        priority: 1

  qwen3-235b-a22b:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1000000
      - unit: Month
        tokens: 20000000
      - unit: Year
        tokens: 240000000
    backends:
      fw-01:
        ref: fw-01
        modelNameOverride: "accounts/fireworks/models/qwen3-235b-a22b"
        priority: 0
      fw-02:
        ref: fw-02
        modelNameOverride: "accounts/fireworks/models/qwen3-235b-a22b"
        priority: 1

  glm-4p6:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1500000
      - unit: Month
        tokens: 35000000
      - unit: Year
        tokens: 420000000
    backends:
      fw-01:
        ref: fw-01
        modelNameOverride: "accounts/fireworks/models/glm-4p6"
        priority: 0
      fw-02:
        ref: fw-02
        modelNameOverride: "accounts/fireworks/models/glm-4p6"
        priority: 1

  # glm-4p5:
  #   enabled: true
  #   envoyRateLimit:
  #     requests: 50000
  #     unit: Minute
  #   backends:
  #     fw-01:
  #       enabled: true
  #       ref: fw-01
  #       modelNameOverride: "accounts/fireworks/models/glm-4p5"
  #       priority: 0
  #     fw-02:
  #       enabled: true
  #       ref: fw-02
  #       modelNameOverride: "accounts/fireworks/models/glm-4p5"
  #       priority: 1

  deepseek-v3p1-terminus:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1500000
      - unit: Month
        tokens: 35000000
      - unit: Year
        tokens: 420000000
    backends:
      fw-01:
        ref: fw-01
        modelNameOverride: "accounts/fireworks/models/deepseek-v3p1-terminus"
        priority: 0
      fw-02:
        ref: fw-02
        modelNameOverride: "accounts/fireworks/models/deepseek-v3p1-terminus"
        priority: 1

  # OpenAI Models
  o4-mini:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 3000000
      - unit: Month
        tokens: 80000000
      - unit: Year
        tokens: 960000000
    backends:
      openai-01:
        ref: openai-01
        modelNameOverride: "o4-mini"
        priority: 0
      openai-02:
        ref: openai-02
        modelNameOverride: "o4-mini"
        priority: 1

  # o4-mini-deep-research:
  #   enabled: true
  #   envoyRateLimit:
  #     requests: 50000
  #     unit: Minute
  #   backends:
  #     openai-01:
  #       enabled: true
  #       ref: openai-01
  #       modelNameOverride: "o4-mini-deep-research"
  #       priority: 0
  #     openai-02:
  #       enabled: true
  #       ref: openai-02
  #       modelNameOverride: "o4-mini-deep-research"
  #       priority: 1

  gpt-4-1:
    envoyRateLimit:
      requests: 30
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1500000
      - unit: Month
        tokens: 35000000
      - unit: Year
        tokens: 420000000
    backends:
      openai-01:
        ref: openai-01
        modelNameOverride: "gpt-4.1"
        priority: 0
      openai-02:
        ref: openai-02
        modelNameOverride: "gpt-4.1"
        priority: 1

  gpt-4-1-mini:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 3000000
      - unit: Month
        tokens: 80000000
      - unit: Year
        tokens: 960000000
    backends:
      openai-01:
        ref: openai-01
        modelNameOverride: "gpt-4.1-mini"
        priority: 0
      openai-02:
        ref: openai-02
        modelNameOverride: "gpt-4.1-mini"
        priority: 1

  gpt-5:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1000000
      - unit: Month
        tokens: 20000000
      - unit: Year
        tokens: 240000000
    backends:
      openai-01:
        ref: openai-01
        modelNameOverride: "gpt-5"
        priority: 0
      openai-02:
        ref: openai-02
        modelNameOverride: "gpt-5"
        priority: 1

  gpt-5-mini:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 3000000
      - unit: Month
        tokens: 80000000
      - unit: Year
        tokens: 960000000
    backends:
      openai-01:
        ref: openai-01
        modelNameOverride: "gpt-5-mini"
        priority: 0
      openai-02:
        ref: openai-02
        modelNameOverride: "gpt-5-mini"
        priority: 1

  gpt-5-nano:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 3000000
      - unit: Month
        tokens: 80000000
      - unit: Year
        tokens: 960000000
    backends:
      openai-01:
        ref: openai-01
        modelNameOverride: "gpt-5-nano"
        priority: 0
      openai-02:
        ref: openai-02
        modelNameOverride: "gpt-5-nano"
        priority: 1

  # codex-mini-latest:
  #   enabled: true
  #   envoyRateLimit:
  #     requests: 50000
  #     unit: Minute
  #   backends:
  #     openai-01:
  #       enabled: true
  #       ref: openai-01
  #       modelNameOverride: "codex-mini-latest"
  #       priority: 0
  #     openai-02:
  #       enabled: true
  #       ref: openai-02
  #       modelNameOverride: "codex-mini-latest"
  #       priority: 1

  text-embedding-3-large:
    envoyRateLimit:
      requests: 10000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 10000000
      - unit: Month
        tokens: 300000000
      - unit: Year
        tokens: 3600000000
    backends:
      openai-01:
        ref: openai-01
        modelNameOverride: "text-embedding-3-large"
        priority: 0
      openai-02:
        ref: openai-02
        modelNameOverride: "text-embedding-3-large"
        priority: 1

  dall-e-3:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    backends:
      openai-01:
        ref: openai-01
        modelNameOverride: "dall-e-3"
        priority: 0
      openai-02:
        ref: openai-02
        modelNameOverride: "dall-e-3"
        priority: 1

  gpt-image-1:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    backends:
      openai-01:
        ref: openai-01
        modelNameOverride: "gpt-image-1"
        priority: 0
      openai-02:
        ref: openai-02
        modelNameOverride: "gpt-image-1"
        priority: 1

  # whisper-1:
  #   enabled: true
  #   envoyRateLimit:
  #     requests: 10000
  #     unit: Minute
  #   backends:
  #     openai-01:
  #       enabled: true
  #       ref: openai-01
  #       modelNameOverride: "whisper-1"
  #       priority: 0
  #     openai-02:
  #       enabled: true
  #       ref: openai-02
  #       modelNameOverride: "whisper-1"
  #       priority: 1

  gpt-4o-mini-audio: 
    envoyRateLimit:
      requests: 10000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 500000
      - unit: Month
        tokens: 12000000
      - unit: Year
        tokens: 144000000
    backends:
      openai-01:
        ref: openai-01
        modelNameOverride: "gpt-4o-mini-audio-preview-2024-12-17"
        priority: 0
      openai-02:
        ref: openai-02
        modelNameOverride: "gpt-4o-mini-audio-preview-2024-12-17"
        priority: 1

  # gpt-4o-transcribe:
  #   enabled: true
  #   envoyRateLimit:
  #     requests: 10000
  #     unit: Minute
  #   backends:
  #     openai-01:
  #       enabled: true
  #       ref: openai-01
  #       modelNameOverride: "gpt-4o-transcribe"
  #       priority: 0
  #     openai-02:
  #       enabled: true
  #       ref: openai-02
  #       modelNameOverride: "gpt-4o-transcribe"
  #       priority: 1

  # gpt-4o-mini-tts:
  #   enabled: true
  #   envoyRateLimit:
  #     requests: 10000
  #     unit: Minute
  #   backends:
  #     openai-01:
  #       enabled: true
  #       ref: openai-01
  #       modelNameOverride: "gpt-4o-mini-tts"
  #       priority: 0
  #     openai-02:
  #       enabled: true
  #       ref: openai-02
  #       modelNameOverride: "gpt-4o-mini-tts"
  #       priority: 1

  # Google Gemini Models
  gemini-2-5-flash:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 3000000
      - unit: Month
        tokens: 80000000
      - unit: Year
        tokens: 960000000
    backends:
      vertex-ai-01:
        ref: vertex-ai-01
        modelNameOverride: "gemini-2.5-flash"
        priority: 0
      vertex-ai-02:
        ref: vertex-ai-02
        modelNameOverride: "gemini-2.5-flash"
        priority: 1

  gemini-2-5-pro-reasoning:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1000000
      - unit: Month
        tokens: 20000000
      - unit: Year
        tokens: 240000000
    backends:
      vertex-ai-01:
        ref: vertex-ai-01
        modelNameOverride: "gemini-2.5-pro"
        priority: 0
      vertex-ai-02:
        ref: vertex-ai-02
        modelNameOverride: "gemini-2.5-pro"
        priority: 1

  gemini-2-5-pro-reasoning-1024:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1000000
      - unit: Month
        tokens: 20000000
      - unit: Year
        tokens: 240000000
    backends:
      vertex-ai-01:
        ref: vertex-ai-01
        modelNameOverride: "gemini-2.5-pro"
        priority: 0
      vertex-ai-02:
        ref: vertex-ai-02
        modelNameOverride: "gemini-2.5-pro"
        priority: 1

  gemini-3-pro-image-preview:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    backends:
      vertex-ai-01:
        ref: vertex-ai-01
        modelNameOverride: "gemini-3-pro-image-preview"
        priority: 0
      vertex-ai-02:
        ref: vertex-ai-02
        modelNameOverride: "gemini-3-pro-image-preview"
        priority: 1

  gemini-2-5-flash-lite:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 3000000
      - unit: Month
        tokens: 80000000
      - unit: Year
        tokens: 960000000
    backends:
      vertex-ai-01:
        ref: vertex-ai-01
        modelNameOverride: "gemini-2.5-flash-lite"
        priority: 0
      vertex-ai-02:
        ref: vertex-ai-02
        modelNameOverride: "gemini-2.5-flash-lite"
        priority: 1

  gemini-3-pro:
    envoyRateLimit:
      requests: 50000 
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 1000000
      - unit: Month
        tokens: 20000000
      - unit: Year
        tokens: 240000000
    backends:
      google-ai-studio-01:
        ref: google-ai-studio-01
        modelNameOverride: "gemini-3-pro-preview"
        priority: 0
      google-ai-studio-02:
        ref: google-ai-studio-02
        modelNameOverride: "gemini-3-pro-preview"
        priority: 1

  gemini-3-flash:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 3000000
      - unit: Month
        tokens: 80000000
      - unit: Year
        tokens: 960000000
    backends:
      google-ai-studio-01:
        ref: google-ai-studio-01
        modelNameOverride: "gemini-3-flash-preview"
        priority: 0
      google-ai-studio-02:
        ref: google-ai-studio-02
        modelNameOverride: "gemini-3-flash-preview"
        priority: 1

  gemini-3-flash-thinking:
    envoyRateLimit:
      requests: 50000
      unit: Minute
    envoyTokenRateLimits:
      - unit: Day
        tokens: 800000
      - unit: Month
        tokens: 15000000
      - unit: Year
        tokens: 180000000
    backends:
      google-ai-studio-01:
        ref: google-ai-studio-01
        modelNameOverride: "gemini-3-flash-preview"
        priority: 0
      google-ai-studio-02:
        ref: google-ai-studio-02
        modelNameOverride: "gemini-3-flash-preview"
        priority: 1
